<!DOCTYPE html>
<html>

<head>
    <title>Yandex. Third task. WebAudio API player.</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Exo+2&subset=latin,cyrillic">
    <link rel="stylesheet" href="./styles/normalize.css">
    <link rel="stylesheet" href="./styles/style.css">
</head>

<body>
    <div class="player">
        <div class="player__add">
            <label class="player__open">
                <input class="player__controls-input" type="file" data-bind="event: { change: function() { open($element.files[0]) } }">
                <div class="player__controls-btn">Откройте трек</div>
            </label>
            или
            <div class="player__drag">
                Перетащите трек сюда
            </div>
        </div>

        <div class="player__track" data-bind="with: currentTrack">
                <div class="player__track-overlay" data-bind="visible: !loaded()"></div>
                <!-- ko if: loaded -->
                <img data-bind="attr: { src: cover }" />
                <span>
                    <div data-bind="text: name"></div>
                    <div data-bind="text: artist"></div>
                    <div data-bind="text: title"></div>
                </span>
                <!-- /ko -->
        </div>
        
        <div class="player__visual">
            <canvas class="player__canvas">
            </canvas>
        </div>
        
        <div class="player__controls">
            <!-- ko if: isPlaying -->
            <div class="player__controls-btn" data-bind="click: $root.stop">Stop</div>
            <!-- /ko -->
            <!-- ko if: !isPlaying() && currentTrack() -->
            <div class="player__controls-btn" data-bind="click: $root.play">Play</div>
            <!-- /ko -->
        </div>
        
    </div>
    <script type="text/javascript" src="./scripts/lib/knockout-3.3.0.js"></script>
    <script type="text/javascript" src="./scripts/lib/id3.js"></script>
    <script type="text/javascript" src="./scripts/app.js"></script>
    <script type="text/javascript">
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
            
        window.app.ActivePlayer = new app.Player();

        ko.applyBindings(window.app.ActivePlayer, document.getElementsByClassName("player")[0]);
    </script>
</body>

</html>